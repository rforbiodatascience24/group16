---
title: "lab07_assignment_group16"
format: html
editor: visual
---

### Load the packages

```{r}
#| message = FALSE  
library("tidyverse") 
library("broom") 
library("cowplot")
```

We now see the $iris$ dataset. We can see the dataset. It consists of a tibble with dimensions $N$ = 150 and $M$ = 5, where $N$ is the number of observations and $M$ the number of features. The label is `species`:

```{r}
iris
```

First, we are going to look the data in PC coordinates. For this, we are going to use the function `prcomp`. We are only using the numeric columns (like the gene expression features) and we scale the data:

```{r}
pca_fit <- iris |>  
  select(where(is.numeric)) |>   
  prcomp(scale = TRUE)
```

Then, we plot the data in PC coordinates:

```{r}
pca_fit |>    
  augment(iris) |>    
  ggplot(aes(.fittedPC1, .fittedPC2,              
             colour = Species)) +    
  geom_point(alpha = 0.5) +   
  theme_minimal() +   
  theme(legend.position = "bottom",          
        plot.title = element_text(hjust = 0.5)) +   
  labs(x = "PC1", 
       y = "PC2", 
       title = "Data in PC coordinates", 
       colour = "Event label")
```
